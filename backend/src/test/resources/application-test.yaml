#######################################################################################################################
#
# Application configuration for tests
#
#######################################################################################################################

---

#
# ------------------------------------------------------------------------------------
# DataSource configuration
# ------------------------------------------------------------------------------------
# See https://docs.spring.io/spring-boot/reference/data/sql.html
#

spring:
  datasource:
    # JDBC URL for an H2 in-memory database with unique name per test run
    #   - jdbc:h2:mem:testdb-${random.uuid}: Creates a unique database for each test run to avoid conflicts
    #   - MODE=MSSQLServer: Enables H2's MS SQL Server compatibility mode. This attempts to mimic
    #     SQL Server syntax and behavior, useful for local development/testing if production uses SQL Server.
    #   - DATABASE_TO_UPPER=false: Prevents H2 from converting unquoted identifiers (table/column names)
    #     to uppercase. Important for compatibility with SQL Server if it's configured for case-sensitivity
    #     or if the schema relies on mixed-case identifiers.
    #   - CASE_INSENSITIVE_IDENTIFIERS=true: Makes unquoted identifiers case-insensitive. Combined with
    #     DATABASE_TO_UPPER=false, this aims to match typical SQL Server case-insensitivity for object names.
    #   - DB_CLOSE_ON_EXIT=TRUE: Ensures the database is closed when the JVM exits
    url: jdbc:h2:mem:testdb-${random.uuid};MODE=MSSQLServer;DATABASE_TO_UPPER=false;CASE_INSENSITIVE_IDENTIFIERS=true;DB_CLOSE_ON_EXIT=TRUE;
  jpa:
    # Defer datasource initialization so that schema.sql and data.sql are loaded after the datasource is fully initialized.
    # This is necessary to ensure that data.sql runs correctly.
    defer-datasource-initialization: true