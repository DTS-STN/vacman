#######################################################################################################################
#
# Example application-local.yaml file...
#
# Copy this file to application-local.yaml and update the values as required.
#
#######################################################################################################################

#
# Disable security configuration for API endpoints.
#

application:
  security:
    disabled: true

---

#
# Log levels.
# Increase or decrease logging as desired.
#

logging:
  level:
    '[ca.gov.dtsstn.vacman.api]': trace
    '[io.micrometer.registry.otlp.OtlpMeterRegistry]': off
    '[org.springframework]': debug

---

#
# Import spring profiles.
# You can import zero or more configsets via spring profiles here.
#

spring:
  profiles:
    include:
      - mssql-local

---

#
# Connect to a local MSSQL database.
#

spring:
  config:
    activate:
      on-profile:
        - mssql-local
  datasource:
    url: jdbc:sqlserver://localhost;databaseName=master;encrypt=false;
    username: sa
    password: p@ssword1
  flyway:
    clean-disabled: false

application:
  flyway:
    clean-on-validation-error: true

---

#
# Configure the MS Graph client secret.
#

spring:
  security:
    oauth2:
      client:
        registration:
          ms-graph:
            client-secret: password

---

#
# Connect to a local H2 database.
#

spring:
  datasource:
    # JDBC URL for an H2 in-memory database.
    #   - jdbc:h2:mem:testdb: Connects to an H2 in-memory database named 'testdb'.
    #   - MODE=MSSQLServer: Enables H2's MS SQL Server compatibility mode. This attempts to mimic
    #     SQL Server syntax and behavior, useful for local development/testing if production uses SQL Server.
    #   - DATABASE_TO_UPPER=false: Prevents H2 from converting unquoted identifiers (table/column names)
    #     to uppercase. Important for compatibility with SQL Server if it's configured for case-sensitivity
    #     or if the schema relies on mixed-case identifiers.
    #   - CASE_INSENSITIVE_IDENTIFIERS=true: Makes unquoted identifiers case-insensitive. Combined with
    #     DATABASE_TO_UPPER=false, this aims to match typical SQL Server case-insensitivity for object names.
    #   - DB_CLOSE_DELAY=-1: Keeps the in-memory database alive as long as the JVM is running,
    #     even if all connections are closed. Crucial for tests or development scenarios where the
    #     database schema and data need to persist across multiple connection acquisitions.
    url: jdbc:h2:mem:testdb;MODE=MSSQLServer;DATABASE_TO_UPPER=false;CASE_INSENSITIVE_IDENTIFIERS=true;DB_CLOSE_DELAY=-1;
  jpa:
    hibernate:
      ddl-auto: update
    defer-datasource-initialization: true
    show-sql: true